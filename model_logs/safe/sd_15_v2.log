Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
01/10/2024 16:12:52 - INFO - __main__ - Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 2
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: fp16

01/10/2024 16:12:52 - INFO - __main__ - Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 2
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: fp16

{'variance_type', 'timestep_spacing', 'clip_sample_range', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'sample_max_value'} was not found in config. Values will be initialized to default values.
{'scaling_factor', 'force_upcast'} was not found in config. Values will be initialized to default values.
{'class_embed_type', 'mid_block_type', 'encoder_hid_dim', 'dual_cross_attention', 'transformer_layers_per_block', 'addition_embed_type', 'dropout', 'addition_time_embed_dim', 'cross_attention_norm', 'upcast_attention', 'time_embedding_act_fn', 'time_embedding_dim', 'time_cond_proj_dim', 'resnet_skip_time_act', 'addition_embed_type_num_heads', 'encoder_hid_dim_type', 'class_embeddings_concat', 'resnet_time_scale_shift', 'time_embedding_type', 'num_attention_heads', 'resnet_out_scale_factor', 'mid_block_only_cross_attention', 'reverse_transformer_layers_per_block', 'conv_out_kernel', 'projection_class_embeddings_input_dim', 'timestep_post_act', 'num_class_embeds', 'only_cross_attention', 'use_linear_projection', 'conv_in_kernel', 'attention_type'} was not found in config. Values will be initialized to default values.
{'class_embed_type', 'mid_block_type', 'encoder_hid_dim', 'dual_cross_attention', 'transformer_layers_per_block', 'addition_embed_type', 'dropout', 'addition_time_embed_dim', 'cross_attention_norm', 'upcast_attention', 'time_embedding_act_fn', 'time_embedding_dim', 'time_cond_proj_dim', 'resnet_skip_time_act', 'addition_embed_type_num_heads', 'encoder_hid_dim_type', 'class_embeddings_concat', 'resnet_time_scale_shift', 'time_embedding_type', 'num_attention_heads', 'resnet_out_scale_factor', 'mid_block_only_cross_attention', 'reverse_transformer_layers_per_block', 'conv_out_kernel', 'projection_class_embeddings_input_dim', 'timestep_post_act', 'num_class_embeds', 'only_cross_attention', 'use_linear_projection', 'conv_in_kernel', 'attention_type'} was not found in config. Values will be initialized to default values.
Traceback (most recent call last):
Traceback (most recent call last):
  File "/gpfs/home/maguilar/TFG/Baby-Face-Generation-Diffusion-Thesis/scripts/training/train_text_to_image.py", line 1135, in <module>
  File "/gpfs/home/maguilar/TFG/Baby-Face-Generation-Diffusion-Thesis/scripts/training/train_text_to_image.py", line 1135, in <module>
        main()main()

  File "/gpfs/home/maguilar/TFG/Baby-Face-Generation-Diffusion-Thesis/scripts/training/train_text_to_image.py", line 714, in main
  File "/gpfs/home/maguilar/TFG/Baby-Face-Generation-Diffusion-Thesis/scripts/training/train_text_to_image.py", line 714, in main
        dataset = load_dataset(dataset = load_dataset(

  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/datasets/load.py", line 2128, in load_dataset
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/datasets/load.py", line 2128, in load_dataset
        builder_instance = load_dataset_builder(builder_instance = load_dataset_builder(

  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/datasets/load.py", line 1814, in load_dataset_builder
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/datasets/load.py", line 1814, in load_dataset_builder
        dataset_module = dataset_module_factory(dataset_module = dataset_module_factory(

  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/datasets/load.py", line 1507, in dataset_module_factory
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/datasets/load.py", line 1507, in dataset_module_factory
        raise FileNotFoundError(raise FileNotFoundError(

FileNotFoundErrorFileNotFoundError: : Couldn't find a dataset script at /gpfs/home/maguilar/TFG/Baby-Face-Generation-Diffusion-Thesis/scripts/training/alexg99-captioned_flickr_faces/alexg99-captioned_flickr_faces.py or any data file in the same directory. Couldn't find 'alexg99-captioned_flickr_faces' on the Hugging Face Hub either: FileNotFoundError: Dataset 'alexg99-captioned_flickr_faces' doesn't exist on the Hub. If the repo is private or gated, make sure to log in with `huggingface-cli login`.Couldn't find a dataset script at /gpfs/home/maguilar/TFG/Baby-Face-Generation-Diffusion-Thesis/scripts/training/alexg99-captioned_flickr_faces/alexg99-captioned_flickr_faces.py or any data file in the same directory. Couldn't find 'alexg99-captioned_flickr_faces' on the Hugging Face Hub either: FileNotFoundError: Dataset 'alexg99-captioned_flickr_faces' doesn't exist on the Hub. If the repo is private or gated, make sure to log in with `huggingface-cli login`.

[2024-01-10 16:13:02,512] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 1346342) of binary: /home/maguilar/project/anaconda3/envs/envname/bin/python
Traceback (most recent call last):
  File "/gpfs/home/maguilar/project/anaconda3/envs/envname/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/accelerate/commands/launch.py", line 1008, in launch_command
    multi_gpu_launcher(args)
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/accelerate/commands/launch.py", line 666, in multi_gpu_launcher
    distrib_run.run(args)
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/maguilar/project/anaconda3/envs/envname/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train_text_to_image.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-01-10_16:13:02
  host      : node026.s.upf.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1346343)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-01-10_16:13:02
  host      : node026.s.upf.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1346342)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
